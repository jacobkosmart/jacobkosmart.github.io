---
title: "UIkit Basic 7 (URLSession, Alamofire)"
excerpt: "UIkit Basic"

categories:
  - uikit

toc: true
toc_sticky: true
---

## ğŸ”· ì›¹ í†µì‹ ê³¼ Protocol

- ì¸í„°ë„· ìƒì—ì„œì˜ í†µì‹ ì„ ë§í•©ë‹ˆë‹¤

- ë§ì€ ì •ë³´ë“¤ì´ ì£¼ê³  ë°›ê¸°ì— ì¸í„°ë„·ì—ëŠ” ì—„ê²©í•œ ê·œì•½ì´ ì¡´ì¬í•˜ëŠ”ë° ì´ê²ƒì„ protocol ì´ë¼ê³  ë¶€ë¦…ë‹ˆë‹¤.

- ì˜ˆë¥¼ë“¤ì–´ ë©”ì¼ì„ ì£¼ê³  ë°›ê¸° ìœ„í•œ SMTP protocol, íŒŒì¼ì „ì†¡ì˜ FTP protocol, ë¸Œë¼ìš°ì €ì™€ ì›¹ì„œë²„ì™€ í†µì‹ í•˜ê¸° ìœ„í•´ì„œ HTTP protocol ë“±ì´ ìˆìŠµë‹ˆë‹¤.

## ğŸ”· HTTP(Hyper Text Transfer Protocol)

- Hyper Text ì „ì†¡í•˜ê¸° ìœ„í•œ protocol

- HTTP ëŠ” ìš”ì²­ì˜ request ì™€ ì‘ë‹µì˜ response ê°€ ìˆìŠµë‹ˆë‹¤. Client ì—ì„œ server ë¡œ ìš”ì²­í•˜ëŠ”ê²ƒì´ í•˜ë©´ ì„œë²„ì—ì„œ ê·¸ì— ë§ëŠ” ì‘ë‹µ ì •ë³´ë¥¼ ë³´ë‚´ ì¤ë‹ˆë‹¤

![image](https://user-images.githubusercontent.com/28912774/146513239-11726d27-c685-4d54-8b0c-043f95e5c33d.png)

![image](https://user-images.githubusercontent.com/28912774/146513598-6e034989-964e-4c76-a33b-24a98c42d1e3.png)

### HTTP íŒ¨í‚·

- HTTP ì‘ë‹µì„ ë°›ì„ ë•Œ ê·¸ ì •ë³´ë¥¼ íŒ¨í‚·ì— ë‹´ê²¨ì„œ ë„£ëŠ”ë°, íŒ¨í‚·ì€ header ì™€ body ë¡œ ì´ë£¨ì›Œì ¸ ìˆìŠµë‹ˆë‹¤.

- Header ì—ëŠ” ì£¼ë¡œ ë³´ë‚´ëŠ” ì‚¬ëŒ, ë°›ëŠ” ì‚¬ëŒì˜ ì£¼ì†Œ, íŒ¨í‚·ì˜ lifecycle

- body ì—ëŠ” userì—ì„œ ì „í•˜ëŠ” ì‹¤ì œ ë‚´ìš©ì´ ë‹´ê²¨ ìˆìŠµë‹ˆë‹¤

### HTTP Method

- GET: í´ë¼ì´ì–¸íŠ¸ê°€ ì„œë²„ì— ë¦¬ì†ŒìŠ¤ë¥¼ ìš”ì²­í•  ë•Œ ì‚¬ìš© (ì¼ë°˜ì ìœ¼ë¡œ ì •ë³´ë¥¼ ë°›ì•„ ì˜¬ë•Œ ì‚¬ìš©)

- POST: í´ë¼ì´ì–¸íŠ¸ê°€ ì„œë²„ì˜ ë¦¬ì†ŒìŠ¤ë¥¼ ìƒˆë¡œ ë§Œë“¤ë•Œ ì‚¬ìš© (ë¡œê·¸ì¸, ê°œì‹œê¸€ ì •ë³´ ë“± data ë¥¼ ë‹´ì•„ì„œ ë³´ë‚´ì•¼ í• ë•Œ ì‚¬ìš©)

- PUT: í´ë¼ì´ì–¸íŠ¸ê°€ ì„œë²„ì˜ ë¦¬ì†ŒìŠ¤ë¥¼ ì „ì²´ ìˆ˜ì • í•  ë•Œ ì‚¬ìš© (íšŒì›ì •ë³´ë¥¼ ì „ì²´ ìˆ˜ì •í• ë•Œ ì£¼ë¡œ ì‚¬ìš©)

- PATCH: í´ë¼ì´ì–¸íŠ¸ê°€ ì„œë²„ì˜ ë¦¬ìŠ¤ì†Œë¥¼ ì¼ë¶€ ìˆ˜ì • í•  ë•Œ ì‚¬ìš© (íšŒì›ì •ë³´ë¥¼ ì¼ë¶€ ìˆ˜ì •í• ë•Œ ì‚¬ìš©)

- DELETE: í´ë¼ì´ì–¸íŠ¸ê°€ ì„œë²„ì˜ ë¦¬ì†ŒìŠ¤ë¥¼ ì‚­ì œ í•  ë•Œ ì‚¬ìš©

- HEAD: í´ë¼ì´ì–¸íŠ¸ê°€ ì„œë²„ì˜ ì •ìƒ ì‘ë™ ì—¬ë¶€ë¥¼ í™•ì¸ í•  ë•Œ ì‚¬ìš©

- OPTIONS: í´ë¼ì´ì–¸íŠ¸ê°€ ì„œë²„ì—ì„œ í•´ë‹¹ URL ì´ ì–´ë–¤ ë©”ì†Œë“œë¥¼ ì§€ì›í•˜ëŠ”ì§€ í™•ì¸ í•  ë•Œ ì‚¬ìš©

- CONNECT: í´ë¼ì´ì–¸íŠ¸ê°€ í”„ë¡ì‹œë¥¼ í†µí•˜ì—¬ ì„œë²„ì™€ SSL í†µì‹ ì„ í•˜ê³ ì í•  ë•Œ ì‚¬ìš©

- TRACE: í´ë¼ì´ì–¸íŠ¸ì™€ ì„œë²„ê°„ í†µì‹  ê´€ë¦¬ ë° ë””ë²„ê¹…ì„ í•  ë•Œ ì‚¬ìš©

### HTTP Status

- 100ë²ˆ ëŒ€ Informational: ìš”ì²­ ì •ë³´ë¥¼ ì²˜ë¦¬ ì¤‘

- 200ë²ˆ ëŒ€ Success: ìš”ì²­ì„ ì •ìƒì ìœ¼ë¡œ ì²˜ë¦¬í•¨

- 300ë²ˆ ëŒ€ Redirection: ìš”ì²­ì„ ì™„ë£Œí•˜ê¸° ìœ„í•´ ì¶”ê°€ ë™ì‘ í•„ìš”

- 400ë²ˆ ëŒ€ Client Error: ì„œë²„ê°€ ìš”ì²­ì„ ì´í•´í•˜ì§€ ëª»í•¨

- 500ë²ˆëŒ€ Server Error: ì„œë²„ê°€ ìš”ì²­ ì²˜ë¦¬ë¥¼ ì‹¤íŒ¨í•¨

## ğŸ”· URLSession

- Apple ì—ì„œ HTTP / HTTPS ì™€ í†µì‹ í•˜ê²Œ ë§Œë“  ê²ƒìœ¼ë¡œ íŠ¹ì •í•œ urlì„ ì´ìš©í•˜ì—¬ ë°ì´í„°ë¥¼ ë‹¤ìš´ë¡œë“œí•˜ê³  ì—…ë¡œë“œ í•˜ê¸° ìœ„í•œ API ê° Session ë‚´ì—ì„œ URL ì€ ìš”ì²­ì„ ë‚˜íƒ€ ë‚´ëŠ” ì¼ë ¨ì˜ ì‘ì—…ì„ ì¶”ê°€ í•©ë‹ˆë‹¤. URLSession ì€ request ì™€ response ë¥¼ ê¸°ë³¸ êµ¬ì¡°ë¥¼ ê°€ì§€ê³  ìˆìŠµë‹ˆë‹¤

- request ëŠ” serverë¡œ ìš”ì²­ì„ ë³´ë‚¼ë•Œ, ì–´ë–¤ http method ë¥¼ ì‚¬ìš©í•  ê²ƒì¸ì§€, cashing ì •ì±…ì„ ì–´ë–»ë° í• ê²ƒì¸ì§€ì— ëŒ€í•œ ì„¤ì •ì„ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

- response ëŠ” url ì˜ ìš”ì²­ì— ì‘ë‹µì„ ë‚˜íƒ€ë‚´ëŠ” ê°ì²´ ì…ë‹ˆë‹¤.

### URLSessionConfiguration, URLSessionTask

- URLSessionConfiguration ì„ í†µí•´ì„œ URLSession ì„ ìƒì„± í•  ìˆ˜ ìˆìœ¼ë©°, ìƒì„±ëœ URLSession ì€ í•œê°œ ì´ìƒì˜ URLSessionTask ì„ ìƒì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤

- URLSession ì— ë‹´ê²¨ìˆëŠ” URLSessionTask ì„ í†µí•´ì„œ ì‹¤ì œ ì„œë²„ì™€ í†µì‹  í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

- URLSession API ëŠ” ì—¬ëŸ¬ê°€ì§€ ìœ í˜•ì˜ session ì„ ì œê³µí•˜ëŠ”ë°, URLSessionConfiguration ì˜ ê°ì²´ì— ì˜í•´ì„œ session property ë¥¼ êµ¬ì„± í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### URLSession ì˜ ì¢…ë¥˜

#### Shared Session (URLSession.shared()) - ê³µìœ  ì„¸ì…˜

- singleton ìœ¼ë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆìœ¼ë©°, ê¸°ë³¸ìš”ì²­ì„ í•˜ê¸° ìœ„í•œ session ì…ë‹ˆë‹¤. custom ì„¤ì •ì€ í•  ìˆ˜ ì—†ì§€ë§Œ, ì‰½ê²Œ ë§Œë“¤ì–´ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤

#### Default Session (URLSession(configuration: .default)) - ê¸°ë³¸ ì„¸ì…˜

- shared session ê³¼ ìœ ì‚¬í•˜ê²Œ ì‘ë™ í•˜ì§€ë§Œ, ì§ì ‘ ì›í•˜ëŠ” ì„¤ì •ì„ í•  ìˆ˜ ìˆìœ¼ë©°, cash, ì¿ í‚¤ ë“±ì„ ì§ì ‘ disk ì— ì €ì¥ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

- ìˆœì°¨ì ìœ¼ë¡œ data ë¥¼ ì²˜ë¦¬í•˜ê¸° ìœ„í•´ delegate ë¥¼ ì§€ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤

#### Ephemeral Session (URLSession(configuration: .ephemeral)) - ì„ì‹œ ì„¸ì…˜

- shared session ê³¼ ë¹„ìŠ· í•˜ì§€ë§Œ, cash, ì¿ í‚¤, ì‚¬ìš©ì ì •ë³´ë“±ì„ disk ì— ì €ì¥í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. ë©”ëª¨ë¦¬ì— ì˜¬ë ¤ì„œ session ì„ ì—°ê²°í•˜ê³ , session ë§Œë£Œì‹œ data ê°€ ì‚¬ë¼ ì§‘ë‹ˆë‹¤

#### Background Session (URLSession(configuration: .background)) - ë°±ê·¸ë¼ìš´ë“œ ì„¸ì…˜

- ì•±ì´ ì‹¤í–‰ë˜ì§€ ì•ŠëŠ” ë™ì•ˆ background ì—ì„œ ì»¨í…ì¸  ì—…ë¡œë“œ ë° ë‹¤ìš´ë¡œë“œë¥¼ ìˆ˜í–‰ í•  ìˆ˜ ìˆëŠ” session ì…ë‹ˆë‹¤

### URLSessionTask ì˜ ì¢…ë¥˜

#### URLSessionDataTask

- data ê°ì²´ë¥¼ ì‚¬ìš©í•˜ì—¬, ë°ì´í„°ë¥¼ ìš”ì²­í•˜ê³  ì‘ë‹µ ë°›ìŠµë‹ˆë‹¤. ì£¼ë¡œ ì§§ê³  ë¹ˆë²ˆí•˜ê²Œ ìš”ì²­í•˜ëŠ” ê²½ìš°ì— ì£¼ë¡œ ì‚¬ìš© ë©ë‹ˆë‹¤

#### URLSessionUploadTask

- data ê°ì²´, íŒŒì¼ í˜•íƒœì˜ data ë¥¼ ì—…ë¡œë“œ í•˜ëŠ” ì‘ì—…ì„ ìˆ˜í–‰ í•©ë‹ˆë‹¤. App ì´ ì‹¤í–‰ë˜ì§€ ì•Šì•˜ì„ ë•Œ, background upload ë¥¼ ì§€ì› í•©ë‹ˆë‹¤.

#### URLSessionDownloadTask

- dataë¥¼ ë°›ì•„ì„œ íŒŒì¼ í˜•íƒœë¡œ ì €ì¥í•˜ëŠ” ì‘ì—…ì„ ë§í•©ë‹ˆë‹¤. App ì´ ì‹¤í–‰ë˜ì§€ ì•Šì•˜ì„ ë•Œ, background upload ë¥¼ ì§€ì› í•©ë‹ˆë‹¤.

#### URLSessionStreamTask

- TCP/IP ì„ ì—°ê²° í•  ë•Œ ìƒì„±í•´ì„œ ì‚¬ìš©í•˜ëŠ” task

#### URLSessionWebSocketTask

- WebSocket í‘œì¤€ì„ í†µí•´ í†µì‹ í•˜ëŠ” task

### URLSession Life Cycle

1. Session Configuration ì„ ê²°ì •í•˜ê³ , Session ì„ ìƒì„±

2. í†µì‹ í•  URL ê³¼ Request ê°ì²´ë¥¼ ì„¤ì •

3. ì‚¬ìš©í•  Task ë¥¼ ê²°ì •í•˜ê³  ê·¸ì— ë§ëŠ” Completion Handler ë‚˜ Delegate ë©”ì†Œë“¤ì„ ì‘ì„±

4. í•´ë‹¹ Task ë¥¼ ì‹¤í–‰

5. Task ì™„ë£Œ í›„ Completion Handler í´ë¡œì € í˜¸ì¶œë¨

### ì˜ˆì œ ì½”ë“œ

```swift
// URLSession ì„ ì´ìš©í•´ì„œ currentWeather APIë¥¼ í˜¸ì¶œí•˜ê¸°
func getCurrentWeather(cityName: String) {
	guard let url = URL(string: "https://api.openweathermap.org/data/2.5/weather?q=\(cityName)&units=metric&lang=kr&appid=0fb8463dce1de96897cba0b1eff08e18") else { return }
	// session ì„ default session ìœ¼ë¡œ ì„¤ì •
	let session = URLSession(configuration: .default)
	// compression handler ë¡œì¨ closure ë§¤ê°œ ë³€ìˆ˜ì— data(ì„œë²„ì—ì„œ ì‘ë‹µ ë°›ì€ data), response(HTTP header ë‚˜ ìƒíƒœ ì½”ë“œì˜ metaData), error(error ì½”ë“œ ë°˜í™˜)
	session.dataTask(with: url) { [weak self] data, response, error in
		// ì‘ë‹µë°›ì€ response (json data)ë¥¼ weatherInfo struct ì— decoding ë˜ê²Œ í•˜ëŠ” logic
		let successRange = (200..<300)
		guard let data = data, error == nil else { return }
		let decorder = JSONDecoder()
		// ì‘ë‹µë°›ì€ data ì˜ statusCode ê°€ 200ë²ˆëŒ€ (200 ~ 299) ì¼ë•Œ
		if let response = response as? HTTPURLResponse, successRange.contains(response.statusCode) {
			guard let weatherInfo =  try? decorder.decode(WeatherInfo.self, from: data) else { return }
			// debugPrint(weatherInfo)
			// ë°›ì•„ì˜¨ ë°ì´í„°ë¥¼ UI ì— í‘œì‹œí•˜ê¸° ìœ„í•´ì„œëŠ” main thread ì—ì„œ ì‘ì—…ì„ ì§„í–‰ í–ì—¬ ë©
			DispatchQueue.main.async {
				self?.weatherStackView.isHidden = false
				self?.configureView(weatherInfo: weatherInfo)
				}
			} else { // status code ê°€ 200 ë²ˆëŒ€ê°€ ì•„ë‹ˆë©´ error ìƒíƒœ ì´ë‹ˆê¹Œ error message ìƒì„± logic
				guard let errorMessage = try? decorder.decode(ErrorMessage.self, from: data) else { return }
				// debugPrint(errorMessage)
				// main thread ì—ì„œ alert ì´ í‘œì‹œë˜ê²Œ í•´ì•¼ë¨
				DispatchQueue.main.async {
					self?.showAlert(message: errorMessage.message)
				}
		}
	}.resume() // app ì´ ì‹¤í–‰ë˜ê²Œ í•¨
	}
```

## ğŸ”· Alamofire

- Alamofire ëŠ” Swift ê¸°ë°˜ì˜ HTTP ë„¤íŠ¸ì›Œí‚¹ ë¼ì´ë¸ŒëŸ¬ë¦¬ ì…ë‹ˆë‹¤. URLSession ì„ ê¸°ë°˜ìœ¼ë¡œ í•œ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¡œì„œ, ë„¤íŠ¸ì›Œí‚¹ ì‘ì—…ì„ ë‹¨ìˆœíˆ í•˜ê³  ë„¤íŠ¸ì›Œí‚¹ì„ ìœ„í•œ ë‹¤ì–‘í•œ method, json parsing ë“±ì„ ì œê³µ í•©ë‹ˆë‹¤.

### Alamofire ì£¼ìš” íŠ¹ì§•

- ì—°ê²° ê°€ëŠ¥í•œ request, response method ë¥¼ ì œê³µí•˜ë©°, URL json parameter encoding ì„ ì§€ì› í•©ë‹ˆë‹¤. íŒŒì¼ ë°ì´í„° ìŠ¤íŠ¸ë¦¬ë°, multi part form date ë“± upload ê¸°ëŠ¥ì„ ì œê³µí•˜ë©°, HTTP response ê²€ì¦ê³¼ ê´‘ë²”ìœ„í•œ Unit Test, í†µí•© Test ë“±ì„ ì§€ì›í•©ë‹ˆë‹¤

#### URLSession ëŒ€ì‹  Alamofire ì„ ì‚¬ìš©í•˜ëŠ” ì´ìœ 

- ì½”ë“œ ê°„ì†Œí™”, ê°€ë…ì„± ì¸¡ë©´ì—ì„œ ë„ì›€ì„ ì£¼ê³  ì—¬ëŸ¬ê¸°ëŠ¥ì„ ì§ì ‘ êµ¬ì¶•í•˜ì§€ ì•Šì•„ë„ ì‰½ê²Œ ì‚¬ìš©í•  ìˆ˜ ìˆìŒ

![image](https://user-images.githubusercontent.com/28912774/146636826-0ab499ca-bd24-41c2-bb06-8be25c2c4ae1.png)

- ìœ„ì˜ code ëŠ” GET ë°©ì‹ì˜ ì½”ë“œ ì‘ì„±ì˜ ê°™ì€ ë¡œì§ì¸ë°, URLSession ì€ URL ìƒì„±, status code error ì²˜ë¦¬ ë“±, ë§ì€ì½”ë“œë¥¼ ì‘ì„±í•´ì•¼ ë˜ì§€ë§Œ, Alamofire ë¥¼ ì‚¬ìš©í•˜ê²Œ ë˜ë©´ ë” ì ì€ code ë¡œ ë˜‘ê°™ì€ ê¸°ëŠ¥ì„ êµ¬í˜„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤

- URLSession ì€ í˜¸ì¶œí•  API ì˜ url ì„ ìƒì„±í•˜ê³ , quayParameter ê°€ ìˆë‹¤ë©´ URL ì„ mapping í•´ì¤˜ì•¼ í•˜ì§€ë§Œ, AlamofireëŠ” ìš”ì²­ì„ ìƒì„±í• ë•Œ, method parameter ì˜ url ì„ ë„˜ê²¨ ì£¼ë©´ ë‚´ë¶€ì—ì„œ ìë™ìœ¼ë¡œ url ì˜ parameter ë¥¼ mapping ì‹œì¼œ ì¤ë‹ˆë‹¤.

- ìœ íš¨ì„± ê²€ì‚¬ì˜ ê²½ìš°ì—ë„, URLSessionì€ response source ë¥¼ URLResponse ë¡œ downCasting í•˜ì—¬ status code property ì— ì ‘ê·¼í•´ì„œ 200 ë²ˆëŒ€ì¸ì§€ ë²ˆí˜¸ ëŒ€ë¥¼ ì§ì ‘ ì‘ì„±í•´ì¤˜ì•¼ í•˜ì§€ë§Œ Alamofire ëŠ” validation method ë§Œ í˜¸ì¶œ í•˜ë©´ ì •ìƒ status code ë²”ìœ„ì—ì„œë§Œ 200ë²ˆëŒ€ ìƒíƒœ ì½”ë“œë§Œ í—ˆìš©í•˜ê²Œ ë§Œë“¤ì–´ ì¤„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### Alamofire Request

- request methodì„ ì´ìš©í•˜ì—¬, HTTP ë¥¼ ì‚¬ìš© í•  ìˆ˜ ìˆëŠ”ë°, method parameterë¡œ URLê³¼ HTTP method, parameter ë“± ìš”ì²­ì— í•„ìš”í•œ ê²ƒì„ ì„¤ì • í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### Alamofire HTTP Method

![image](https://user-images.githubusercontent.com/28912774/146638092-11c6d87c-d9d7-4d1d-b4f1-27f142c6c52c.png)

- Alamofire HTTP method ë˜í•œ ì§€ì›ì„ í•˜ëŠ”ë°, ëŒ€í‘œì ì¸ HTTP method ëŠ” REST API ì—ì„œ ì´ìš©ë˜ëŠ” GET, POST, PUT, PATCH, DELETE ì´ ì •ì˜ ë˜ì–´ ìˆìœ¼ë©°, ìš”ì²­ì„ ë§Œë“¤ë•Œ, request parameter ì— HTTP method ë“¤ì„ ì „ë‹¬ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### Alamofire Response

![image](https://user-images.githubusercontent.com/28912774/146638158-7edc4242-9be4-4dcb-a516-ce74dc7510b7.png)

- Alamofire ëŠ” ìš”ì²­ì— ëŒ€í•œ ì‘ë‹µì„ response method ì„ ì´ìš©í•˜ì—¬ handling í•˜ëŠ”ë°, ìœ„ì˜ ê·¸ë¦¼ê³¼ ê°™ì´ 6ê°œì˜ ì„œë¡œ ë‹¤ë¥¸ response code ê°€ ì •ì˜ ë˜ì–´ ìˆìœ¼ë©°, ì‘ë‹µì´ ì™„ë£Œë˜ë©´ completionHandler ë¥¼ í˜¸ì¶œí•´ì„œ ì²˜ë¦¬ í•©ë‹ˆë‹¤

![image](https://user-images.githubusercontent.com/28912774/146638248-1b261b1d-fe0d-4a4e-b771-b21989bba9f5.png)

- ìœ„ì™€ ê°™ì´ request method ë¥¼ changing í•˜ì—¬ ì‚¬ìš©ë˜ê²Œ ë©ë‹ˆë‹¤

## ğŸ”· Cocoapods

- Apple platform ì—ì„œ ê°œë°œì„ í•  ë•Œ, ì™¸ë¶€ ë¼ì´ë¸Œë¥¼ ê´€ë¦¬í•˜ê¸° ì‰½ë„ë¡ ë„ì™€ì£¼ëŠ” ì˜ì¡´ì„± ê´€ë¦¬ë„êµ¬ ì…ë‹ˆë‹¤

- í”„ë¡œì íŠ¸ì—ì„œ í•„ìš”í•œ ì™¸ë¶€ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì‰½ê²Œ ê´€ë¦¬í•˜ê³ , ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

> Cocoapods official site - https://cocoapods.org/

### Cocoapods ì„¤ì¹˜

```bash
$ sudo gem install cocoapods
```

### Cocoapods í”„ë¡œì íŠ¸ì— ì ìš©

- xcode ë¡œ ìƒˆë¡œìš´ project ë¥¼ ìƒì„±í•˜ë©´ ê·¸ ê²½ë¡œì— terminal ë¡œ ê°€ì„œ Podfile ìƒì„± í•©ë‹ˆë‹¤

```bash
pod init
```

- Podfile ì„ ìˆ˜ì •í•˜ê²Œ ë˜ë©´ ì™¸ë¶€ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ê°€ì ¸ì˜¤ê±°ë‚˜, ìˆ˜ì • í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤

### Alamofire ì„¤ì¹˜

- ì„¤ì¹˜ëœ Podfile ì—ì„œ alamofire ë¥¼ ì¶”ê°€ ì‹œí‚µë‹ˆë‹¤

```ruby
# Uncomment the next line to define a global platform for your project
# platform :ios, '9.0'

target '07_covid_app' do
  # Comment the next line if you don't want to use dynamic frameworks
  use_frameworks!
  pod 'Alamofire', '~> 5.5'
  # Pods for 07_covid_app

end
```

- Podfile ì €ì¥ í›„ì—, terminal ì—ì„œ `pod install` í•´ì£¼ë©´ package ì„¤ì¹˜ ì™„ë£Œ

- ì„¤ì¹˜í•œ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì‚¬ìš©í•˜ê¸° ìœ„í•´ì„œëŠ” ì›ë˜ xcode file ì´ ì•„ë‹Œ, .xcworkspace í™•ì¥ìë¥¼ ê°€ì§„ ìƒˆë¡œìš´ íŒŒì¼ì´ ìƒì„± ë˜ëŠ”ë° ê·¸ê²ƒì„ ì‹¤í–‰í•´ì•¼ì§€ë§Œ, ì™¸ë¶€ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤

### completionHandler ì˜ escaping closure ì„ ì–¸ ì´ìœ 

- func ì—ì„œ escape ì„ ì–¸ì€ í•¨ìˆ˜ì˜ scope ë¥¼ ë²—ì–´ ë‚˜ì„œë„ ë³€ìˆ˜ê°€ ì°¸ì¡° ë  ìˆ˜ ìˆê²Œ í•˜ëŠ” í´ë¡œì ¸ ì„. ì¦‰, í•¨ìˆ˜ì˜ ì¸ìë¡œ closure ê°€ ì „ë‹¬ë˜ì§€ë§Œ, ë°˜í™˜ëœ í›„ì—ë„ ì‹¤í–‰ë˜ëŠ” ê²ƒì„ ì˜ë¯¸í•©ë‹ˆë‹¤.

- escaping closure ë¥¼ ì‚¬ìš©í•˜ëŠ” ëŒ€í‘œì ì¸ ê²½ìš°ëŠ” ë¹„ë™ê¸° ì‘ì—…ì„ í•˜ëŠ” ê²½ìš° completionHandler ë¡œì„œ escaping closure ë¥¼ ë§ì´ ì‚¬ìš©í•©ë‹ˆë‹¤. ë³´í†µ ë„¤íŠ¸ì›Œí‚¹ í†µì‹ ì€ ë¹„ë™ê¸° ì‘ì—…ìœ¼ë¡œ ì²˜ë¦¬ ë˜ëŠ”ë°, `.responseData` ì— ì •ì˜ëœ `completionHandler closure` ëŠ” fetch data ê°€ ë°˜í™˜ ëœ í›„ì—, í˜¸ì¶œì´ ë©ë‹ˆë‹¤. ì™œëƒí•˜ë©´, ì„œë²„ì—ì„œ ë°ì´í„°ë¥¼ ì–¸ì œ ì‘ë‹µ í•´ì¤„ì§€ ëª¨ë¥´ê³ , ì‘ë‹µì‹œê°„ì´ ë¡œë”© ë˜ê¸° ë•Œë¬¸ì— server ì—ì„œ ë¹„ë™ê¸°ë¡œ ì‘ë‹µ ë°›ê¸° ì „ì— ì¦‰, .responseData ì— ì „ë‹¬í•œ parameter ê°€ completionHandlerê°€ í˜¸ì¶œë˜ê¸° ì „ì— í•¨ìˆ˜ê°€ ì¢…ë£Œë˜ì„œ ì„œë²„ì˜ ì‘ë‹µì„ ë°›ì•„ë„ ë™ì‘í•˜ì§€ ì•Šê²Œ ë©ë‹ˆë‹¤

- ê·¸ë˜ì„œ, ë¹„ë™ê¸° ì‘ì—…ì„ completionHandler ë¡œ callback ì„ ì‹œì¼œì¤˜ì•¼ í•œë‹¤ë©´, escaping closure ë¥¼ ì‚¬ìš©í•˜ì—¬ í•¨ìˆ˜ê°€ return ëœ í›„ì—ë„, ì‹¤í–‰ ì‹œì¼œì¤˜ì•¼ í•©ë‹ˆë‹¤

```swift
// in viewDidLoad.swift

	// fetch data SearchCovideOverview
	func fetchCovidOverview(
		// API ë¥¼ í†µí•´ì„œ severì—ì„œ json dat ë¥¼ ë°›ê±°ë‚˜, ìš”ì²­ì— ì‹¤íŒ¨ í•˜ì˜€ì„ë•Œ completionHandler ë¥¼ í˜¸ì¶œí•´ì„œ í•´ë‹¹ closure ë¥¼ ì •ì˜í•˜ëŠ” ê³³ì— ì‘ë‹µë°›ì€ dataë¥¼ ì „ë‹¬ í•´ì•¼ í•©ë‹ˆë‹¤
		// completionHandler ë¥¼ @escaping closure ê°€ ë˜ê²Œ ì„¤ì •
		completionHandler: @escaping (Result<CityCovidOverView, Error>) -> Void
	) {
		let url = "https://api.corona-19.kr/korea/country/new/"
		let param = [
			"serviceKey": "16KIXAdhg7tk93ivjzsHFCQ8oOLyNSUuE"
		]

		// Alamofire ë¥¼ í†µí•´ì„œ API í˜¸ì¶œ
		AF.request(url, method: .get, parameters: param)
			.responseData(completionHandler: { response in
				switch response.result {
				case let .success(data):
					do {
						let decoder = JSONDecoder()
						let result = try decoder.decode(CityCovidOverView.self, from: data)
						completionHandler(.success(result))
					} catch { // error code ì²˜ë¦¬
						completionHandler(.failure(error))
					}
				case let .failure(error):
					completionHandler(.failure(error))
				}
			})
	}

```

---

ğŸ”¶ ğŸ”· ğŸ“Œ ğŸ”‘ ğŸ‘‰

## ğŸ—ƒ Reference

weatherApp-iOS-practice code - [https://github.com/jacobkosmart/weatherApp-iOS-practice.git](https://github.com/jacobkosmart/weatherApp-iOS-practice.git)

ë‚˜ë¥¸í•œ ì½”ë”© - [https://nareunhagae.tistory.com/44](https://nareunhagae.tistory.com/44)

codewithchrist - [https://codewithchris.com/alamofire/](https://codewithchris.com/alamofire/)

fastcampus - [https://fastcampus.co.kr/dev_online_iosappfinal](https://fastcampus.co.kr/dev_online_iosappfinal)
