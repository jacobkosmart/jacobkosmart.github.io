---
title: "01.Unit Test (ë‹¨ìœ„ í…ŒìŠ¤íŠ¸)"
excerpt: "Test"

categories:
  - Test

toc: true
toc_sticky: true
last_modified_at:
---

---

# 1.í…ŒìŠ¤íŠ¸ ê°œìš”

## Unit Test 

- ë‹¨ìœ„(Unit) í…ŒìŠ¤íŠ¸ë€ ë°ì´í„°(ìƒíƒœ), í•¨ìˆ˜(ë©”ì†Œë“œ), ì»´í¬ë„ŒíŠ¸ ë“±ì˜ ì •ì˜ëœ í”„ë¡œê·¸ë¨ ìµœì†Œ ë‹¨ìœ„ë“¤ì´ ë…ë¦½ì ìœ¼ë¡œ ì •ìƒ ë™ì‘í•˜ëŠ”ì§€ í™•ì¸í•˜ëŠ” ë°©ë²•. 

- ì¦‰ ì£¼ê´€ì ìœ¼ë¡œ ì •ì˜ëœ ê²ƒì— ëŒ€í•œ í•˜ë‚˜í•˜ë‚˜ë¥¼ í…ŒìŠ¤íŠ¸ í•˜ëŠ” ê°œë…ì„. 

- ë‚˜ì¤‘ì— ìˆ˜ì •í•  ë¶€ë¶„ì´ ìˆìœ¼ë©´ í…ŒìŠ¤íŠ¸ í•œ í•­ëª©ì„ ê¸°ë°˜ìœ¼ë¡œ ë” ì•ˆì •ì ìœ¼ë¡œ ìˆ˜ì •ì„ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

- ì‘ì„±í•œ ë¡œì§ì´ ì½”ë“œìœ„ì£¼ë¡œ í…ŒìŠ¤íŠ¸ë¥¼ í•˜ê¸° ë•Œë¬¸ì— ê°€ë³ê³ , ë” ë¹ ë¥´ê²Œ í…ŒìŠ¤íŠ¸ë¥¼ ì§„í–‰ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

- ëŒ€í‘œì ì¸ Unit Test tool ë¡œëŠ” Jest ê°€ ìˆìŠµë‹ˆë‹¤. (JavaScript test ìš©)


## E2E Test 

- E2E (End to End) í…ŒìŠ¤íŠ¸ë€ ì–´í”Œë¦¬ì¼€ì´ì…˜ì˜ ì²˜ìŒë¶€í„° ëê¹Œì§€ì˜ ì‹¤ì œ ì‚¬ìš©ìì˜ ê´€ì ì—ì„œ ì‚¬ìš© íë¦„ì„ í…ŒìŠ¤íŠ¸ í•˜ëŠ” ë°©ë²•ì…ë‹ˆë‹¤.

- ì‹¤ì œ ë¸Œë¼ìš°ì € í™”ë©´ì—ì„œ ë§Œë“¤ì–´ì§„ ì‚¬ì´íŠ¸ë¥¼ ì§ì ‘ ì‚¬ìš©í•˜ë©´ì„œ ì‚¬ìš©í•˜ëŠ” í…ŒìŠ¤íŠ¸ì…ë‹ˆë‹¤.

- ëŒ€í‘œì ì¸ E2E test tool ë¡œëŠ” cypress ê°€ ìˆìŠµë‹ˆë‹¤.


# 2.í…ŒìŠ¤íŠ¸ í™˜ê²½ì„¤ì • 

- ì˜ˆì œ App test íŒŒì¼ë¡œëŠ” Jacob's DevLog ì˜ portfolio ì— ìˆëŠ” `Book-Search App` ì„ í†µí•´ ì§„í–‰ í•˜ê² ìŠµë‹ˆë‹¤. (Vue.js ê¸°ë°˜)

- Vue.js ì—ì„œ unit test ë¥¼ ì§„í–‰í•˜ê¸° ìœ„í•´ì„  ì•„ë˜ì™€ ê°™ì€ package ë¥¼ ì„¤ì¹˜ í•´ì•¼ í•©ë‹ˆë‹¤.

    - jest

    - vue test-utils

    - vue-jest

    - babel-jest


- package ì„¤ì¹˜

`$ npm i -D jest @vue/test-utils@next vue-jest@next babel-jest`


- root ê²½ë¡œì— `jest.config.js` íŒŒì¼ ìƒì„± -> í…ŒìŠ¤íŠ¸ í•  í™˜ê²½ì„¤ì • ì„¤ì •

```js
// in jest.config.js

module.exports = {
  // íŒŒì¼ í™•ì¥ìë¥¼ ì§€ì •í•˜ì§€ ì•Šì€ ê²½ìš°, Jest ê°€ ê²€ìƒ‰í•  í™•ì¥ì ëª©ë¡ì…ë‹ˆë‹¤.
  // ì¼ë°˜ì ìœ¼ë¡œ ë§ì´ ì‚¬ìš©ë˜ëŠ” ëª¨ë“ˆì˜ í™•ì¥ìë¥¼ ì§€ì •í•©ë‹ˆë‹¤.
  // e.g `import HellowWorld from '~/components/HelloWorld';`
  moduleFileExtensions: [
    'js',
    'vue'
  ],

  // `~` ì™€ ê°™ì€ ê²½ë¡œ ë³„ì¹­ì„ ë§¤í•‘í•©ë‹ˆë‹¤.
  // `< rootDir>` í† í°ì„ ì‚¬ìš©í•´ ë£¨íŠ¸ ê²½ë¡œë¥¼ ì°¸ì¡°í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
  moduleNameMapper: {
    '^~/(.*)$': '<rootDir>/src/$1' // regexp ë¡œ ~/ ë¡œ ì‹œì‘ë˜ëŠ” ëª¨ë“  ë¬¸ìì—´ì€ root ê²½ë¡œì˜ src í´ë”ì•ˆì˜ ëª¨ë“  ê²½ë¡œë¥¼ ë§í•¨
  },

  // ì¼ì¹˜í•˜ëŠ” ê²½ë¡œì—ì„œëŠ” ëª¨ë“ˆì„ ê°€ì ¸ì˜¤ì§€ ì•ŠìŠµë‹ˆë‹¤.
  // `<rootDir>` í† í°ì„ ì‚¬ìš©í•´ ë£¨íŠ¸ ê²½ë¡œë¥¼ ì°¸ì¡°í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
  modulePathIgnorePatterns: [
    '<rootDir>/node_modules',
    '<rootDir>/dist'
  ],

  // jsdom í™˜ê²½ì— ëŒ€í•œ URL ì„ ì„¤ì •í•©ë‹ˆë‹¤.
  // https://github.com/facebook/jest/issues/6766
  testURL: 'https://localhost',

  // ì •ê·œì‹ê³¼ ì¼ì¹˜í•˜ëŠ” íŒŒì¼ì˜ ë³€í™˜ ëª¨ë“ˆì„ ì§€ì •í•©ë‹ˆë‹¤.
  transform: {
    '^.+\\.vue$': 'vue-jest',
    '^.+\\.js$': 'babel-jest'
  }
}

```

- eslint ê°€ ì„¤ì¹˜ ë˜ì–´ ìˆìœ¼ë©´ test ì‹œ ì¶©ëŒ í•  ìˆ˜ ìˆê¸° ë•Œë¬¸ì— ì‚¬ì „ì— ì •ì˜ëœ ì „ì—­ ë³€ìˆ˜ë¥¼ ë¯¸ë¦¬ ì„¤ì • í•´ì£¼ì–´ì•¼ í•©ë‹ˆë‹¤. root ê²½ë¡œì— ìˆëŠ”  `.eslintrc.js` ì—ì„œ..

```js
// in .eslintrc.js
module.exports = {
  // ì‚¬ì „ì— ì •ì˜ëœ ì „ì—­ ë³€ìˆ˜ ì„¤ì •
  env: {
    browser: true,
    node: true,
    jest: true
  }

```

# 3.ì´ˆê¸° í…ŒìŠ¤íŠ¸ ì‹¤í–‰

- ì˜ˆë¥¼ ë“¤ì–´ í•˜ë‚˜ì˜ js íŒŒì¼ì„ test í•˜ê¸° ìœ„í•´ì„  ë°ì´í„°(í•¨ìˆ˜) ë“±ì„ export í•  ìˆ˜ ìˆëŠ” í†µë¡œë¥¼ ë§Œë“¤ì–´ ì¤˜ì•¼ì§€ test ì‘ë™ íŒŒì¼ë¡œ ë°ì´í„°ë¥¼ ë‚´ë³´ë‚´ì•¼ í•©ë‹ˆë‹¤. ë‹¤ìŒê³¼ ê°™ì´ export ë¥¼ í•´ì£¼ì–´ì•¼ í•©ë‹ˆë‹¤.

```js
// in example.js

export function double(num) {
  return num * 2
}
```

- ì¦‰, vue ë‚˜ js íŒŒì¼ì•ˆì— ìˆëŠ” íŒŒì¼ì˜ ë°ì´í„°ë‚˜, í•¨ìˆ˜ëŠ” export ë¥¼ í•˜ì§€ ì•Šìœ¼ë©´ ê²°êµ­ í…ŒìŠ¤íŠ¸ë¥¼ í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.


- script ìƒì—ì„œ jest ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆê²Œ `packge.json` íŒŒì¼ì—ì„œ script ë“±ë¡ì„ ë‹¤ìŒê³¼ ê°™ì´ í•´ì¤ë‹ˆë‹¤.

```json
  "scripts": {
    "test:unit": "jest --watchAl" // watchAll flag ì€ ë³€ê²½ì‚¬í•­ì´ ë°œìƒ ë  ê²½ìš° ìë™ìœ¼ë¡œ ê°ì§€í•´ì„œ test í™˜ê²½ì„ ë‹¤ì‹œí•œë²ˆ ë™ì‘ ì‹œí‚¤ëŠ” flag ì…ë‹ˆë‹¤
  }
```

- test í•  ë¶€ë¶„ ì‘ì„±

```js
// in example.test.js

import { expect, test } from '@jest/globals'
import { double } from './example'

test('Sample test', () => {
  expect(123).toBe(123)
})
```

- terminal ì—ì„œ `$ npm run test:unit` ì„ ì‹¤í–‰í•˜ë©´ ë‹¤ìŒê³¼ ê°™ìŒ ê°™ì€ ë©”ì„¸ì§€ê°€ ì¶œë ¥ë©ë‹ˆë‹¤.

![image](https://user-images.githubusercontent.com/28912774/122634253-12d06680-d118-11eb-9b20-811abaab8717.png)


- ë§Œì•½ test ì—ì„œ fail í•  ê²½ìš° ë‹¤ìŒê³¼ ê°™ì´ ì¶œë ¥ ë©ë‹ˆë‹¤.

```js
// in example.test.js

import { expect, test } from '@jest/globals'
import { double } from './example'

test('Sample test', () => {// expect ëŠ” ì‹¤ì œ ë“¤ì–´ì˜¤ëŠ” ê°’ì´ê³ , tobe ëŠ” í•¨ìˆ˜ ì‹¤í–‰ ì‹œ, ì¶œë ¥ì´ ì˜ˆìƒë˜ëŠ” ê°’ì„ ê°€ë¦¬í‚´ 
  expect(123).toBe('123') // ì¼ë¶€ë¡œ 123ì„ str ë¡œ ë³€í™˜í•´ì„œ test ì§„í–‰ -> fail ìœ ë„
})
```
![image](https://user-images.githubusercontent.com/28912774/122634324-85414680-d118-11eb-84ed-e5726b79343d.png)


- `received` ëŠ” ë°›ì€ ê°’ì„ ì˜ë¯¸í•˜ê³ , `expected` ëŠ” ê¸°ëŒ€ë˜ëŠ” ê°’ì„ ê°€ë¦¬í‚¤ëŠ”ë° ë‘ê°œì˜ ê°’ì´ ì¼ì¹˜ í•˜ì§€ ì•Šê¸° ë•Œë¬¸ì— `test` ì—ì„œ `fail` ì´ ë‚˜íƒ€ë‚˜ê²Œ ë¨

- ë§ˆì°¬ê°€ì§€ë¡œ ë‹¤ë¥¸ test ë¥¼ ì‹¤í–‰í•©ë‹ˆë‹¤. ì¼ë‹¨ `tobe()` ì— ì„ì˜ì˜ ê°’ì„ ì…ë ¥í•˜ê³ , `test()` ë¥¼ ì‹¤í–‰í•˜ë©´ `fail` ì´ ë‚˜ì˜¤ëŠ”ë° `expected` ê°’ì„ `received` ê°’ìœ¼ë¡œ ë°”ê¿”ì„œ ë„£ì–´ì£¼ë©´ `pass` ê°€ ë©ë‹ˆë‹¤


```js
import { expect, test } from '@jest/globals'
import { double } from './example'

test('parameter is a number', () => {
  expect(double(3)).toBe(7)
})
```

![image](https://user-images.githubusercontent.com/28912774/122638953-31435b80-d132-11eb-9b63-4b5872cc39a3.png)

![image](https://user-images.githubusercontent.com/28912774/122638986-589a2880-d132-11eb-80df-d159e1043880.png)


# 4.Jest Globals

> [Jest ì „ì—­ í•¨ìˆ˜ ìì„¸íˆ ë³´ê¸°](https://jestjs.io/docs/api)


## test()

- test ë¼ëŠ” ì „ì—­ í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•´ì„œ ê°ê°ì˜ ìš©ë„ë¡œ êµ¬ë¶„í•´ì¤Œ. ì²« ë²ˆì§¸ parameter ëŠ” test ì˜ ì´ë¦„ì„ ëª…ì‹œí•˜ê³ , ë‘ë²ˆì§¸ parameterë¡œëŠ” callBack í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•´ì„œ ì‹¤ì œ í…ŒìŠ¤íŠ¸ë¥¼ ì§„í–‰ í•´ì£¼ë©´ ë˜ëŠ”ê±°ì„

- ì˜ˆ)
```js
test('did not rain', () => {
  expect(inchesOfRain()).toBe(0);
});
```

## describe()

- í…ŒìŠ¤íŠ¸ í•¨ìˆ˜ë“¤ì„ ë¬¶ì–´ ë‚´ëŠ” í•¨ìˆ˜. ì¼ì¢…ì˜ test() ë¥¼ group í™” í•´ì¤€ë‹¤ëŠ” ê²ƒ 

- í˜•ì‹ë„ test() ì™€ ë§ˆì°¬ê°€ì§€ë¡œ ì²˜ìŒ parameter ëŠ” ì´ë¦„, ë‘ë²ˆì§¸ëŠ” callback í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•¨

- describe() ë¥¼ ì‚¬ìš©í•˜ëŠ” ì´ìœ ëŠ”, before(), after() í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ê¸° ìœ„í•´ì„œ ì‚¬ìš©í•©ë‹ˆë‹¤


## beforeAll()

- ìœ„ì™€ ë§ˆì°¬ê°€ì§€ë¡œ ì´ë¦„, callback í˜•íƒœë¡œ ì‚¬ìš©

- describe() ì•ˆì— ëª¨ë“  test ê°€ ì§„í–‰ë˜ê¸° ì „ì— í•œë²ˆë§Œ ì‹¤í–‰ í•©ë‹ˆë‹¤

## afterAll()

- ëª¨ë“  test ê°€ ì§„í–‰ë˜ê³  ë‚˜ì„œ ë‹¤ìŒì— ì‹œí–‰ë  ê²ƒì„ ëª…ì‹œí•¨

## beforeEach()

- ê°ê°ì˜ test ê°€ ì‹¤í–‰ë˜ê¸° ì§ì „ì— í•œë²ˆì”© ë™ì‘í•  ìˆ˜ ìˆëŠ” êµ¬ì¡°

## afterEach()

- ê°ê°ì˜ test ê°€ ëë‚˜ê³  ë‚˜ì„œ í•œë²ˆì”© ë™ì‘í•  ìˆ˜ ìˆëŠ” êµ¬ì¡°

```js
import { expect, test } from '@jest/globals'
import { double } from './example'


describe('group1', () => {
  beforeAll(() => {
    console.log('beforeAll')
  })
  afterAll(() => {
    console.log('afterAll')
  })

  beforeEach(() => {
    console.log('beforeEach')
  })
  afterEach(() => {
    console.log('afterEach')
  })

  test('Sample test', () => {
    console.log('sample test')
    expect(123).toBe(123) // expect ëŠ” ì‹¤ì œ ë“¤ì–´ì˜¤ëŠ” ê°’ì´ê³ , tobe ëŠ” í•¨ìˆ˜ ì‹¤í–‰ ì‹œ, ì¶œë ¥ì´ ì˜ˆìƒë˜ëŠ” ê°’ì„ ê°€ë¦¬í‚´ 
  })

  test('parameter is a number', () => {
    console.log('parameter is a number')
    expect(double(3)).toBe(6)
    expect(double(10)).toBe(20)
  })

  test('No Parameter', () => {
    console.log('No parameter')
    expect(double()).toBe(0)
  })
})

```

![image](https://user-images.githubusercontent.com/28912774/122693148-8f2b8c80-d273-11eb-9b84-e2cc2ac2ba5a.png)


# 5.Jest Marchers

> [Jest expect ìì„¸íˆ ë³´ê¸°..](https://jestjs.io/docs/expect)

## expect(), .tobe()

- ì‹¤ì œ ê°’ (expect) ì™€ ê¸°ëŒ€ë˜ëŠ” ê°’ (tobe) ë¥¼ ì„œë¡œ ë¹„êµí•´ì„œ test ë¥¼ ë¹„êµí•˜ëŠ” ê²ƒ

```js
const can = {
  name: 'pamplemousse',
  ounces: 12,
};

describe('the can', () => {
  test('has 12 ounces', () => {
    expect(can.ounces).toBe(12);
  });

  test('has a sophisticated name', () => {
    expect(can.name).toBe('pamplemousse');
  });
});
```

- `excpect(), tobe()` ì˜ ë¹„êµ ë˜ëŠ” ê°’ì€ **ì›ì‹œí˜• ë°ì´í„°** (ë¬¸ì, ìˆ«ì , boolean ë°ì´í„°) ê²½ìš°ì— ì‚¬ìš©ë˜ë©°, **ì°¸ì¡°í˜• ë°ì´í„°** (ë°°ì—´, ê°ì²´) ë“±ì€ `toEqual()` ë¡œ í•´ì£¼ì–´ì•¼ í•©ë‹ˆë‹¤.


## toEqul()

```js
const can1 = {
  flavor: 'grapefruit',
  ounces: 12,
};
const can2 = {
  flavor: 'grapefruit',
  ounces: 12,
};

describe('the La Croix cans on my desk', () => {
  test('have all the same properties', () => {
    expect(can1).toEqual(can2);
  });
  test('are not the exact same can', () => {
    expect(can1).not.toBe(can2);
  });
});
```

- ìœ„ì˜ ì½”ë“œì™€ ê°™ì´ ê°ì²´ ë°ì´í„°ì˜ ì¬ê·€ë¥¼ í†µí•´ì„œ ë¨¼ì € ë‘ê°œì˜ ì†ì„±ì˜ name ì´ ê°™ì€ì§€ ë¹„êµ í•˜ê³ , ê·¸ ë‹¤ìŒì— ì‹¤ì œ value ë¶€ë¶„ì´ ê°™ì€ì§€ ë¹„êµí•´ì„œ ê°™ì„ ê²½ìš° pass ë¥¼ ì‹œí‚¤ëŠ” ê²ƒì…ë‹ˆë‹¤

- ë³€ìˆ˜ê°€ ë‹¤ë¥´ê¸° ë•Œë¬¸ì— can1 ê³¼ can2 ëŠ” ë‹¤ë¥¸ ê°ì²´ ë°ì´í„° ì„ (ë‹¤ë¥¸ ë©”ëª¨ë¦¬ì— ì €ì¥ ë˜ìˆëŠ”ê²ƒ) ë‚´ë¶€ê°’ì´ ê°™ë”ë¼ë„ code ìƒì—ì„œ `can1 === can2` ì„ í•˜ê²Œ ë˜ë©´ `false` ê°€ ë¨. `toEqual()` ì„ ì‚¬ìš©í•´ì„œ ë‹¤ë¥¸ ë©”ëª¨ë¦¬ì— ì €ì¥ ë˜ì–´ ìˆì§€ë§Œ ì‹¤ì œ ì•ˆì— ë“¤ì–´ ìˆëŠ” ê°’ë§Œ ë¹„êµí•´ì„œ test ë¥¼ í•©ë‹ˆë‹¤

- `.not` ì„ ì‚¬ìš©í•´ì„œ ë§ˆì¹˜ ! ì™€ ê°™ì´ ë¶€ì • ì—°ì‚°ìë¥¼ ì‚¬ìš©í•´ì„œ ë¹„êµ test í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. 

- test ì˜ˆì‹œ (`toBe()`, `toEqual()`)

```js

const userA = {
  name: 'Jacob',
  age: 80
}

const userB = {
  name: 'Emma',
  age: 22
}

test('ë°ì´í„°ê°€ ì¼ì¹˜í•´ì•¼ í•©ë‹ˆë‹¤', () => {
  expect(userA.age).toBe(80)
  expect(userA).toEqual({
    name: 'Jacob',
    age: 80
  })
})

test('ë°ì´í„°ê°€ ì¼ì¹˜í•˜ì§€ ì•Šì•„ì•¼ í•©ë‹ˆë‹¤', () => {
  expect(userB.name).not.toBe('Jacob')
  expect(userB).not.toEqual(userA)
})
```

# 6.ë¹„ë™ê¸° í…ŒìŠ¤íŠ¸

- íŠ¹ì •í•œ ì½”ë“œì— ë¹„ë™ê¸° ì½”ë“œë¥¼ ì‘ì„±í•  ê²½ìš°, ì‹¤ì œ test ì˜ ì…ì¥ì—ì„œëŠ” ì–¼ë§ˆë‚˜ ê¸°ë‹¤ë ¤ì•¼ ë˜ëŠ”ì§€ ëª¨ë¥´ê¸° ë•Œë¬¸ì—, ë³„ë„ë¡œ ê¸°ë‹¤ë¦¬ì§€ ì•Šê³  ë°”ë¡œ testë¥¼ ì§„í–‰ í•©ë‹ˆë‹¤. ê·¸ë˜ì„œ ë§ˆì§€ë§‰ ë¶€ë¶„ì— ë¹„ë™ê¸° í•¨ìˆ˜ë¥¼ í˜¸ì¶œì„ ì‹œì¼œ ì¤˜ì•¼ì§€ test ì…ì¥ì—ì„œ ë¹„ë™ê¸° í•¨ìˆ˜ì˜ ì‘ë™ì´ ëë‚ ë•Œ ê¹Œì§€ ê¸°ë‹¤ ë¦½ë‹ˆë‹¤.

- ë¨¼ì € í†µê³¼í•˜ëŠ” í…ŒìŠ¤íŠ¸ code ë¶€í„° ì‘ì„±í•˜ëŠ” ê²ƒì´ ì•„ë‹ˆë¼, ì‹¤íŒ¨í•˜ëŠ” test ë¶€í„° ì‘ì„±ì„ í•´ì„œ ì‹¤ì œ ì–´ë– í•œ ê°’ì´ ì œê³µì´ ë˜ì—ˆê³ , ì–´ë– í•œ ê°’ì´ ê¸°ëŒ€ê°€ ë˜ì„œ test ê°€ ì‹¤íŒ¨ í–ˆëŠ”ì§€ í•­ìƒ í™•ì¸ì„ í•œ ë‹¤ìŒì— ì½”ë“œë¥¼ ìˆ˜ì •í•´ì„œ test ë¥¼ pass í•˜ê²Œ ë” ë§Œë“¤ì–´ì•¼ í•©ë‹ˆë‹¤.

```js
// in example.js

export function asyncFn() {
  return new Promise(resolve => {
    setTimeout(() => {
      resolve('Done!')
    }, 2000)
  })
}
```

```js
// in example.test.js

import { describe, expect, test } from '@jest/globals'
import { asyncFn } from './example'

describe('ë¹„ë™ê¸° í…ŒìŠ¤íŠ¸', () => {
  test('done', (done) => {
    asyncFn().then(res => {
      expect(res).toBe('Done!')
      done()
    })
  })

  test('then', () => {
    asyncFn().then(res => {
      expect(res).toBe('Done!')
    })
  })

  test('resolves', () => expect(asyncFn()).resolves.toBe('Done!'))

  // ì£¼ë¡œ ë¹„ë™ê¸° test ë¥¼ í• ë•ŒëŠ” async awit ì„ ì‚¬ìš©í•´ì„œ ì§ê´€ì ì¸ code ë¥¼ ì‘ì„±í•˜ëŠ” ê²Œ ì¢‹ìŒ
  test('async/await', async () => {
    const res = await asyncFn()
    expect(res).toBe('Done!')
  })
})
```

- ë¹„ë™ê¸° í•¨ìˆ˜ì—ì„œ setTimeout() ì„ 6ì´ˆë¡œ ì„¤ì •í•˜ë©´ ì•„ë˜ì™€ ê°™ì´ fail ì´ ë‚˜ì˜¤ê²Œ ë©ë‹ˆë‹¤. ì™œëƒë©´ timeout ì˜ ìµœëŒ€ ì‹œê°„ì´ ê¸°ë³¸ê°’ìœ¼ë¡œ 5ì´ˆ (5000ms) ë¡œ ì„¤ì • ë˜ì–´ ìˆê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.


![image](https://user-images.githubusercontent.com/28912774/123053486-e6ca2380-d43e-11eb-84db-d19927bfa0ea.png)


- ë§Œì•½ 6ì´ˆ í›„ê¹Œì§€ ê¸°ë‹¤ë¦° í›„ì— ì‹¤í–‰í•˜ê²Œ í•˜ë ¤ë©´, test code ì—ì„œ 3ë²ˆì§¸ parameter ë¡œì¨ ì‹œê°„ì„ ë°”ê¿”ì„œ ëª…ì‹œ í•˜ë©´ ë©ë‹ˆë‹¤. (ì²«ë²ˆì§¸ëŠ” test ì˜ ì´ë¦„, ë‘ë²ˆì§¸ëŠ” ì‹¤ì œ test ì˜ ë‚´ìš©ì„ ëª…ì‹œí•˜ëŠ” ì½œë°±í•¨ìˆ˜, ì„¸ë²ˆì§¸ëŠ” ê¸°ë³¸ê°’ìœ¼ë¡œ 5000 ì´ë¼ëŠ” ê°’ì´ ìƒëµ ë˜ì–´ ìˆëŠ” ê²ƒì„)

```js
import { describe, expect, test } from '@jest/globals'
import { asyncFn } from './example'

describe('ë¹„ë™ê¸° í…ŒìŠ¤íŠ¸', () => {
  // ì£¼ë¡œ ë¹„ë™ê¸° test ë¥¼ í• ë•ŒëŠ” async awit ì„ ì‚¬ìš©í•´ì„œ ì§ê´€ì ì¸ code ë¥¼ ì‘ì„±í•˜ëŠ” ê²Œ ì¢‹ìŒ
  test('async/await', async () => {
    const res = await asyncFn()
    expect(res).toBe('Done!')
  }, 7000)
})
```

# 7.ëª¨ì˜ (Mock)í•¨ìˆ˜

- ë‹¨ìœ„ test ë¼ëŠ” ê²ƒì€ ìµœì†Œí•œì˜ ë‹¨ìœ„ (í•¨ìˆ˜ì˜ ë¡œì§, ë°ì´í„°) ë¥¼ test í•˜ëŠ” ê²ƒì´ê¸° ë•Œë¬¸ì— ê±¸ë¦¬ëŠ” ì‹œê°„ë„ ìµœì†Œí•œ ì‹œì¼œ ì¤˜ì•¼ í•©ë‹ˆë‹¤. ìµœëŒ€í•œ ì‹œê°„ì´ ê±¸ë¦¬ëŠ” logic ì„ ë‹¨ìˆœí™” ì‹œì¼œ ì¤„ í•„ìš”ê°€ ìˆìŠµë‹ˆë‹¤. ê·¸ë•Œ, ì‚¬ìš©ë˜ëŠ”ê²ƒì´ ëª¨ì˜ í•¨ìˆ˜ ë¼ëŠ” ê²ƒì…ë‹ˆë‹¤.

- í…ŒìŠ¤íŠ¸ì— ë°©í•´ë˜ëŠ” ê°œë… (ì§€ì—°ì‹œê°„ ë“±) ì„ ë¬´ì‹œí•˜ê³ , ê°€ì§œ(ëª¨ì˜)ì˜ ê°œë…ìœ¼ë¡œ í•¨ìˆ˜ë¥¼ ë§Œë“¤ì–´ì„œ value ê°’ë§Œ í™•ì¸í•  ìˆ˜ ìˆê²Œ test ë¥¼ ì§„í–‰ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```js
// ì˜ˆì‹œë¡œ ì´ì „ì˜ code ì—ì„œ ì§€ì—°ì‹œê°„ì´ 7000ìœ¼ë¡œ ì„¤ì • ë˜ì–´ ìˆì§€ë§Œ, ëª¨ì˜ í•¨ìˆ˜ë¥¼ ë§Œë“¤ì–´ì„œ ì§€ì—°ì‹œê°„ì„ ë¬´ì‹œí•˜ê³  ë¹ ë¥¸ ì‹œê°„ì— testë¥¼ ì§„í–‰í•  ìˆ˜ ìˆìŒ

import { describe, expect, jest, test } from '@jest/globals'
import * as example from './example'

describe('ë¹„ë™ê¸° í…ŒìŠ¤íŠ¸', () => {
  test('async/await', async () => {
    jest.spyOn(example, 'asyncFn').mockResolvedValue('Done!') // ëª¨ì˜ í•¨ìˆ˜ ì‹¤í–‰
    const res = await example.asyncFn()
    expect(res).toBe('Done!')
  }, 7000)
})
```

![image](https://user-images.githubusercontent.com/28912774/123060577-d36e8680-d445-11eb-9e24-28101ff6e0de.png)


- ë¹„ë™ê¸° í…ŒìŠ¤íŠ¸ë¥¼ ì§„í–‰ í•  ê²½ìš° ì™¸ë¶€ìš”ì¸ë“¤ì˜ ì˜í–¥ì„ ë°›ì§€ ì•Šê³  test ê°€ pass ë  ìˆ˜ ìˆê²Œ ëª¨ì˜ í•¨ìˆ˜ë¥¼ ì˜ ì‚¬ìš©í•´ì•¼ í•©ë‹ˆë‹¤. (ì˜ˆ ì¸í„°ë„· ì—°ê²°ì´ ì•ˆë  ê²½ìš° ì™¸ë¶€ API í˜¸ì¶œì´ ì•ˆë˜ì„œ test ê°€ ì‹¤íŒ¨í•˜ì§€ë§Œ, ëª¨ì˜ í•¨ìˆ˜ë¥¼ ë§Œë“¤ì–´ ë†“ê³  test ë¥¼ ì§„í–‰í•˜ë©´ ì™¸ë¶€ ìš”ì¸ì— ì˜í–¥ì„ ë°›ì§€ ì•ŠìŠµë‹ˆë‹¤.)

- ì˜ˆì‹œë¡œ ombd api ì—ì„œ title Frozen II ë¥¼ Frozen ii ë¡œ ë³€í™˜ í•˜ëŠ” test ë¥¼ ëª¨ì˜í•¨ìˆ˜ë¥¼ í†µí•´ì„œ test ë¥¼ ì§„í–‰í•˜ëŠ” code ì˜ˆì‹œ ì…ë‹ˆë‹¤.

```js
// in example.js

import axios from 'axios';
import _upperFirst from 'lodash/upperFirst'
import _toLower from 'lodash/toLower'

export async function fetchMovieTitle() {
  const res = await axios.get('https://omdbapi.com?apikey=7035c60c&i=tt4520988')
  return _upperFirst(_toLower(res.data.Title)) // Frozen II => Frozen ii ì˜í™” ì œëª© ë’¤ì— ëŒ€ë¬¸ì I ë¥¼ ì†Œë¬¸ì i ë¡œ ë°”ê¿”ì„œ ì¶œë ¥í•˜ê¸°
}
```

```js
// in example.test.js

import { describe, expect, jest, test } from '@jest/globals';
import { fetchMovieTitle } from './example';
import axios from 'axios'

describe('ë¹„ë™ê¸° í…ŒìŠ¤íŠ¸', () => {
  // omdb ì—ì„œ í˜¸ì¶œí•˜ëŠ” ê²°ê³¼ ê¸°ëŒ€ ê°’ì„ ì„ì˜ë¡œ ëª¨ì˜ í•¨ìˆ˜ë¥¼ ë§Œë“¤ì–´ì„œ ê°€ì§€ê³  ì˜¤ëŠ” db runtime ì— ìƒê³¼ ì—†ì´ í…ŒìŠ¤íŠ¸ë¥¼ ì§„í–‰ í•  ìˆ˜ ìˆìŒ
  // ì„œë²„ì—ì„œ ë°ì´í„°ë¥¼ ê°€ì§€ê³  ì˜¬ ìˆ˜ ì—†ì–´ë„ test ë¥¼ í•  ìˆ˜ ìˆëŠ”ê±°ì„ (ì¦‰, ì¸í„°ë„·ì´ ì—°ê²°ì´ ì•ˆëœ ìƒíƒœì—ì„œë„ test ëŠ” ëœë‹¤ëŠ” ì˜ë¯¸ì„)
  axios.get = jest.fn(() => {
    return new Promise(resolve => {
      resolve({
        data: {
          Title: 'Frozen II'
        }
      })
    })
  })
  test('ì˜í™”ì œëª© ë³€í™˜', async () => {
    const title = await fetchMovieTitle()
    expect(title).toBe('Frozen ii')
  })
})
```


ğŸ”¶ ğŸ”·  ğŸ“Œ ğŸ”‘

## Reference

- jest docs - [https://jestjs.io/docs/api](https://jestjs.io/docs/api){:target="\_blank"}

- A Beginner's Guide to Unit-testing with Jest - [https://dev.to/dsasse07/a-beginner-s-guide-to-unit-testing-with-jest-45cc](https://dev.to/dsasse07/a-beginner-s-guide-to-unit-testing-with-jest-45cc){:target="\_blank"}
